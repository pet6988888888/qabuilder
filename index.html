<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cookbook Cover Creator</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load html2canvas for image export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- Custom Font Configuration for Tailwind -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        // 15 Total Custom fonts for variety
                        'inter': ['Inter', 'sans-serif'],
                        'serif': ['Playfair Display', 'serif'],
                        'mono': ['Space Mono', 'monospace'],
                        'oswald': ['Oswald', 'sans-serif'],
                        'pacifico': ['Pacifico', 'cursive'],
                        'slab': ['Roboto Slab', 'serif'],
                        'lobster': ['Lobster', 'cursive'],
                        'lora': ['Lora', 'serif'],
                        'montserrat': ['Montserrat', 'sans-serif'],
                        'fjalla': ['Fjalla One', 'sans-serif'],
                        'marker': ['Permanent Marker', 'cursive'],
                        'bebas': ['Bebas Neue', 'sans-serif'],
                        'dancing': ['Dancing Script', 'cursive'],
                        'righteous': ['Righteous', 'cursive'],
                        'vollkorn': ['Vollkorn', 'serif'],
                    },
                    colors: {
                        'primary-bg': '#333333',
                        'secondary-bg': '#4CAF50', // Default green from the example
                    }
                }
            }
        }
    </script>
    <style>
        /* UPDATED: Imported all 15 font families */
        @import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Dancing+Script:wght@400;700&family=Fjalla+One:wght@400;700&family=Inter:wght@400;700&family=Lobster&family=Lora:wght@400;700&family=Montserrat:wght@700&family=Oswald:wght@700&family=Pacifico&family=Permanent+Marker&family=Playfair+Display:wght@700&family=Righteous&family=Roboto+Slab:wght@700&family=Space+Mono&family=Vollkorn:wght@700&display=swap');
        
        /* Ensures the thumb of the range input is styled */
        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            background: #4A4A4A;
            border-radius: 4px;
            margin: 10px 0;
        }

        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4CAF50;
            cursor: pointer;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
        }

        .control-group {
            margin-bottom: 1.5rem;
            padding: 1rem;
            border-radius: 0.5rem;
            background-color: #3f3f46; /* Tailwind gray-700 */
        }
        
        /* Style for temporary error message */
        .error-message {
            z-index: 1000;
            animation: fadeInOut 5s forwards;
        }

        @keyframes fadeInOut {
            0% { opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { opacity: 0; }
        }

        /* FIX: Cover preview responsive sizing */
        #cover-preview-container {
            max-height: calc(100vh - 6rem);
            width: auto;
            height: auto;
        }

        /* Ensure the preview wrapper centers and constrains properly */
        .preview-wrapper {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            padding: 1rem;
        }

        /* @media print for browser printing consistency */
        @media print {
            /* Hide controls and general page elements */
            #controls {
                display: none !important;
            }

            /* Ensure the cover preview container takes up the page and centers */
            .max-w-6xl {
                max-width: 100% !important;
                display: block !important;
            }
            .lg\:col-span-2 {
                width: 100% !important;
                flex: 1 1 100% !important;
                display: block !important;
            }
            .gap-8 {
                gap: 0 !important;
            }

            /* The cover element itself must scale correctly */
            #cover-preview-container {
                max-width: 100% !important; 
                width: 100% !important;
                margin: 0 auto; 
                /* Remove box shadows for clean print */
                box-shadow: none !important;
            }
            
            /* Crucial: Ensure the image maintains aspect ratio on print */
            #cover-image {
                width: 100%;
                height: 100%;
                object-fit: cover;
                object-position: center;
                display: block;
            }
        }
    </style>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const controls = {
                // Content
                subHeadlineInput: document.getElementById('sub-headline-input'), 
                headlineInput: document.getElementById('headline-input'),
                sloganInput: document.getElementById('slogan-input'),
                imageFileInput: document.getElementById('image-file-input'), 
                
                // Logo
                logoFileInput: document.getElementById('logo-file-input'), 
                logoSize: document.getElementById('logo-size'),
                
                // Layout
                imagePosition: document.getElementById('image-position'),

                // Background/Gradient
                bgColor: document.getElementById('bg-color'), 
                bgColor2: document.getElementById('bg-color-2'), 
                gradientDirection: document.getElementById('gradient-direction'), 
                
                // Image Effects
                overlayColor: document.getElementById('overlay-color'),
                overlayOpacity: document.getElementById('overlay-opacity'),
                grayscaleToggle: document.getElementById('grayscale-toggle'),

                // Divider Controls
                dividerColor: document.getElementById('divider-color'),
                dividerThickness: document.getElementById('divider-thickness'),
                
                // Border Controls (NEW)
                borderToggle: document.getElementById('border-toggle'),
                borderColor: document.getElementById('border-color'),
                borderWidth: document.getElementById('border-width'),
                
                // Sub-Headline Styles (Updated with Position)
                subHeadlinePosition: document.getElementById('sub-headline-position'), // NEW
                subHeadlineColor: document.getElementById('sub-headline-color'),
                subHeadlineFont: document.getElementById('sub-headline-font'),
                subHeadlineSize: document.getElementById('sub-headline-size'),

                // Headline Styles
                headlineColor: document.getElementById('headline-color'),
                headlineFont: document.getElementById('headline-font'),
                headlineSize: document.getElementById('headline-size'),
                
                // Slogan Styles
                sloganColor: document.getElementById('slogan-color'),
                sloganFont: document.getElementById('slogan-font'),
                sloganSize: document.getElementById('slogan-size'),
            };

            const previewElements = {
                coverPreviewContainer: document.getElementById('cover-preview-container'),
                coverPreview: document.getElementById('cover-preview'),
                imageSection: document.getElementById('image-section'),
                coverImage: document.getElementById('cover-image'),
                // Image Overlay
                imageOverlay: document.getElementById('image-overlay'),
                textSection: document.getElementById('text-section'),
                
                // Divider Element
                dividerLine: document.getElementById('divider-line'), 
                
                // Text Elements
                logoImage: document.getElementById('logo-image'), 
                subHeadlineText: document.getElementById('sub-headline-text'), 
                headline: document.getElementById('headline'),
                slogan: document.getElementById('slogan'),

                // Displays
                headlineSizeDisplay: document.getElementById('headline-size-display'),
                sloganSizeDisplay: document.getElementById('slogan-size-display'),
                subHeadlineSizeDisplay: document.getElementById('sub-headline-size-display'),
                dividerThicknessDisplay: document.getElementById('divider-thickness-display'), 
                logoSizeDisplay: document.getElementById('logo-size-display'),
                overlayOpacityDisplay: document.getElementById('overlay-opacity-display'),
                borderWidthDisplay: document.getElementById('border-width-display'),
                downloadPngBtn: document.getElementById('download-png-btn'),
                downloadJpgBtn: document.getElementById('download-jpg-btn'),
            };

            const fontMap = {
                'inter': 'Inter, sans-serif',
                'serif': 'Playfair Display, serif',
                'mono': 'Space Mono, monospace',
                'oswald': 'Oswald, sans-serif',
                'pacifico': 'Pacifico, cursive',
                'slab': 'Roboto Slab, serif',
                'lobster': 'Lobster, cursive',
                'lora': 'Lora, serif',
                'montserrat': 'Montserrat, sans-serif',
                'fjalla': 'Fjalla One, sans-serif',
                'marker': 'Permanent Marker, cursive',
                'bebas': 'Bebas Neue, sans-serif',
                'dancing': 'Dancing Script, cursive',
                'righteous': 'Righteous, cursive',
                'vollkorn': 'Vollkorn, serif',
            };

            const hexToRgba = (hex, alpha) => {
                const r = parseInt(hex.slice(1, 3), 16);
                const g = parseInt(hex.slice(3, 5), 16);
                const b = parseInt(hex.slice(5, 7), 16);
                return `rgba(${r}, ${g}, ${b}, ${alpha})`;
            };
            
            // Store original image data for proper export
            let originalImageData = null;
            
            /**
             * Updates the cover design based on current control values.
             */
            function updateCover() {
                const position = controls.imagePosition.value;

                // 1. Layout Control: Set Order and Ratio
                previewElements.coverPreview.classList.remove('flex-col', 'flex-col-reverse');
                if (position.includes('bottom')) {
                    previewElements.coverPreview.classList.add('flex-col-reverse');
                } else {
                    previewElements.coverPreview.classList.add('flex-col');
                }

                if (position.includes('2-3')) {
                    previewElements.imageSection.style.flexGrow = '2';
                    previewElements.textSection.style.flexGrow = '1';
                } else {
                    previewElements.imageSection.style.flexGrow = '1';
                    previewElements.textSection.style.flexGrow = '1';
                }

                // 2. Text Section Background (Gradient UPDATED)
                const color1 = controls.bgColor.value;
                const color2 = controls.bgColor2.value;
                const direction = controls.gradientDirection.value;

                if (direction === 'solid') {
                    previewElements.textSection.style.backgroundImage = 'none';
                    previewElements.textSection.style.backgroundColor = color1;
                } else {
                    previewElements.textSection.style.backgroundImage = `linear-gradient(${direction}, ${color1}, ${color2})`;
                    previewElements.textSection.style.backgroundColor = color1; // Fallback
                }


                // 3. Divider Line Updates
                const thickness = controls.dividerThickness.value;
                previewElements.dividerLine.style.backgroundColor = controls.dividerColor.value;
                previewElements.dividerLine.style.height = `${thickness}px`;
                previewElements.dividerThicknessDisplay.textContent = `${thickness}px (Set to 0 to hide)`;

                // 4. Logo Updates
                const logoHeight = controls.logoSize.value;
                previewElements.logoImage.style.maxHeight = `${logoHeight}px`;
                previewElements.logoSizeDisplay.textContent = `${logoHeight}px (Set to 0 to hide logo)`;
                
                if (parseInt(logoHeight) > 0) {
                    previewElements.logoImage.classList.remove('hidden');
                } else {
                    previewElements.logoImage.classList.add('hidden');
                }
                
                // 5. Image Effects (NEW)
                const opacity = controls.overlayOpacity.value / 100;
                const overlayColor = controls.overlayColor.value;
                const grayscale = controls.grayscaleToggle.checked;
                
                // Grayscale Filter on Image
                previewElements.coverImage.style.filter = grayscale ? 'grayscale(100%)' : 'none';
                
                // Color Overlay on separate div
                previewElements.imageOverlay.style.backgroundColor = hexToRgba(overlayColor, opacity);
                previewElements.overlayOpacityDisplay.textContent = `${controls.overlayOpacity.value}%`;

                // 6. Sub-Headline Updates (NEW: Position and Styles)
                previewElements.subHeadlineText.textContent = controls.subHeadlineInput.value;
                previewElements.subHeadlineText.style.color = controls.subHeadlineColor.value;
                previewElements.subHeadlineText.style.fontFamily = fontMap[controls.subHeadlineFont.value];
                previewElements.subHeadlineText.style.fontSize = `${controls.subHeadlineSize.value}px`;
                previewElements.subHeadlineSizeDisplay.textContent = `${controls.subHeadlineSize.value}px`;
                
                // Position logic: Apply order-last to move it below slogan
                const subHeadlinePosition = controls.subHeadlinePosition.value;
                previewElements.subHeadlineText.classList.remove('order-last'); 
                if (subHeadlinePosition === 'bottom') {
                    previewElements.subHeadlineText.classList.add('order-last');
                }

                // 7. Headline Updates
                previewElements.headline.textContent = controls.headlineInput.value;
                previewElements.headline.style.color = controls.headlineColor.value;
                previewElements.headline.style.fontFamily = fontMap[controls.headlineFont.value];
                previewElements.headline.style.fontSize = `${controls.headlineSize.value}px`;
                previewElements.headlineSizeDisplay.textContent = `${controls.headlineSize.value}px`;
                
                // 8. Slogan Updates
                previewElements.slogan.textContent = controls.sloganInput.value;
                previewElements.slogan.style.color = controls.sloganColor.value;
                previewElements.slogan.style.fontFamily = fontMap[controls.sloganFont.value];
                previewElements.slogan.style.fontSize = `${controls.sloganSize.value}px`;
                previewElements.sloganSizeDisplay.textContent = `${controls.sloganSize.value}px`;
                
                // 9. Border Updates (NEW)
                const borderEnabled = controls.borderToggle.checked;
                const borderColor = controls.borderColor.value;
                const borderWidth = controls.borderWidth.value;
                
                if (borderEnabled) {
                    previewElements.coverPreviewContainer.style.border = `${borderWidth}px solid ${borderColor}`;
                } else {
                    previewElements.coverPreviewContainer.style.border = 'none';
                }
                previewElements.borderWidthDisplay.textContent = `${borderWidth}px`;
            }

            /**
             * Converts the cover preview element into a high-resolution file (PNG or JPEG) and triggers download.
             * FIX: Properly maintains aspect ratio by using background-image approach during capture.
             */
            async function generateAndDownload(format) {
                const elementToCapture = previewElements.coverPreviewContainer;
                const targetWidthPx = 2480; 
                // Calculate height based on the actual element's aspect ratio to prevent distortion
                const aspectRatio = elementToCapture.offsetHeight / elementToCapture.offsetWidth;
                const targetHeightPx = Math.round(targetWidthPx * aspectRatio);

                const scale = targetWidthPx / elementToCapture.offsetWidth;
                
                const mimeType = format === 'jpg' ? 'image/jpeg' : 'image/png';
                const quality = format === 'jpg' ? 0.95 : 1.0; 
                const filename = `cookbook_cover.${format}`;

                // FIX: Store original image styles and temporarily modify for capture
                const imageElement = previewElements.coverImage;
                const imageSectionElement = previewElements.imageSection;
                
                // Store original styles
                const originalImageStyle = imageElement.getAttribute('style') || '';
                const originalSectionStyle = imageSectionElement.getAttribute('style') || '';
                const originalImageClass = imageElement.className;
                
                // FIX: Get the EXACT computed dimensions BEFORE any changes
                const sectionRect = imageSectionElement.getBoundingClientRect();
                const sectionHeight = sectionRect.height;
                const originalFlexGrow = imageSectionElement.style.flexGrow;
                
                // FIX: Convert the image to a background-image approach for proper capture
                const imgSrc = imageElement.src;
                const grayscale = controls.grayscaleToggle.checked;
                
                // FIX: Set explicit height on image section BEFORE hiding the image
                // This prevents the flex container from collapsing
                imageSectionElement.style.height = `${sectionHeight}px`;
                imageSectionElement.style.flexGrow = '0';
                imageSectionElement.style.flexShrink = '0';
                
                // Hide the img element and use background-image on the section
                imageElement.style.display = 'none';
                imageSectionElement.style.backgroundImage = `url('${imgSrc}')`;
                imageSectionElement.style.backgroundSize = 'cover';
                imageSectionElement.style.backgroundPosition = 'center';
                imageSectionElement.style.backgroundRepeat = 'no-repeat';
                if (grayscale) {
                    imageSectionElement.style.filter = 'grayscale(100%)';
                }

                try {
                    const canvas = await html2canvas(elementToCapture, {
                        scale: scale,
                        useCORS: true,
                        allowTaint: true,
                        logging: false,
                        width: elementToCapture.offsetWidth,
                        height: elementToCapture.offsetHeight,
                    });
                    
                    // Use the canvas directly from html2canvas - it's already at the correct proportions
                    const dataUrl = canvas.toDataURL(mimeType, quality);
                    const link = document.createElement('a');
                    link.download = filename;
                    link.href = dataUrl;
                    link.click();
                } catch (error) {
                    console.error('Error generating image:', error);
                    const errorDiv = document.createElement('div');
                    errorDiv.className = 'error-message fixed top-4 left-1/2 -translate-x-1/2 bg-red-600 text-white p-4 rounded-lg shadow-xl';
                    errorDiv.textContent = 'Error generating image. Please try again or use a different image.';
                    document.body.appendChild(errorDiv);
                    setTimeout(() => errorDiv.remove(), 5000); 
                } finally {
                    // FIX: Restore ALL original styles after capture
                    imageElement.style.display = '';
                    imageElement.setAttribute('style', originalImageStyle);
                    imageElement.className = originalImageClass;
                    
                    // Remove the temporary styles
                    imageSectionElement.style.height = '';
                    imageSectionElement.style.flexShrink = '';
                    imageSectionElement.style.backgroundImage = '';
                    imageSectionElement.style.backgroundSize = '';
                    imageSectionElement.style.backgroundPosition = '';
                    imageSectionElement.style.backgroundRepeat = '';
                    imageSectionElement.style.filter = '';
                    
                    // Restore flex-grow
                    imageSectionElement.style.flexGrow = originalFlexGrow || '';
                }
            }


            // --- Dedicated Image File Handler ---
            controls.imageFileInput.addEventListener('change', function(event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        previewElements.coverImage.src = e.target.result;
                    };
                    reader.readAsDataURL(file);
                } else {
                    previewElements.coverImage.src = "https://placehold.co/2480x3508/4CAF50/FFFFFF?text=Upload+Recipe+Image";
                }
            });

            // --- Dedicated Logo File Handler ---
            controls.logoFileInput.addEventListener('change', function(event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        previewElements.logoImage.src = e.target.result;
                        if (controls.logoSize.value === '0') {
                            controls.logoSize.value = 50;
                        }
                        updateCover(); 
                    };
                    reader.readAsDataURL(file);
                } else {
                    previewElements.logoImage.src = "https://placehold.co/100x40/000000/FFFFFF?text=LOGO";
                    controls.logoSize.value = 0; // Hide logo if file is cleared
                    updateCover(); 
                }
            });

            // Attach event listeners for all controls
            [
                controls.headlineInput, controls.sloganInput, controls.subHeadlineInput, 
                controls.imagePosition, 
                controls.bgColor, controls.bgColor2, controls.gradientDirection, 
                controls.dividerColor, controls.dividerThickness, 
                controls.logoSize,
                // New/Updated controls
                controls.subHeadlinePosition, controls.subHeadlineColor, controls.subHeadlineFont, controls.subHeadlineSize, 
                controls.headlineColor, controls.headlineFont, controls.headlineSize, 
                controls.sloganColor, controls.sloganFont, controls.sloganSize,
                controls.overlayColor, controls.overlayOpacity, controls.grayscaleToggle,
                // Border controls (NEW)
                controls.borderToggle, controls.borderColor, controls.borderWidth
            ]
            .forEach(control => {
                control.addEventListener('input', updateCover);
                control.addEventListener('change', updateCover); 
            });

            // Attach listeners for the download buttons
            previewElements.downloadPngBtn.addEventListener('click', () => generateAndDownload('png'));
            previewElements.downloadJpgBtn.addEventListener('click', () => generateAndDownload('jpg'));

            // Initial call to set up the cover with default values
            updateCover();
        });
    </script>
</head>
<body class="bg-primary-bg min-h-screen p-4 md:p-8 font-inter">

    <!-- FIXED: Layout with proper height constraints -->
    <div class="max-w-6xl mx-auto flex flex-col lg:flex-row gap-6 lg:h-[calc(100vh-4rem)]">
        
        <!-- Controls Panel - Scrollable on desktop -->
        <div id="controls" class="lg:w-2/5 w-full p-6 bg-gray-800 rounded-xl shadow-2xl overflow-y-auto lg:h-full">
            <h2 class="text-3xl font-bold text-white mb-6 border-b border-gray-700 pb-3">Cover Customization</h2>

            <!-- Download Buttons -->
            <div class="control-group p-0 rounded-lg">
                <button id="download-png-btn" class="w-full p-3 text-white font-bold text-lg bg-green-700 rounded-t-lg hover:bg-green-600 transition-colors duration-200 focus:outline-none focus:ring-4 focus:ring-green-500 focus:ring-opacity-50">
                    Download PNG (A4)
                </button>
                <button id="download-jpg-btn" class="w-full p-3 text-white font-bold text-lg bg-yellow-600 rounded-b-lg hover:bg-yellow-500 transition-colors duration-200 focus:outline-none focus:ring-4 focus:ring-yellow-500 focus:ring-opacity-50">
                    Download JPG (A4)
                </button>
            </div>
            
            <!-- Text & Content Controls (REORDERED FOR CLARITY) -->
            <div class="control-group">
                <h3 class="text-xl font-semibold text-white mb-3">Content</h3>
                
                <!-- MOVED TO TOP: Headline Text -->
                <label for="headline-input" class="block text-sm font-medium text-gray-300 mb-1">Headline Text</label>
                <input type="text" id="headline-input" value="MONTH TEN" class="w-full p-2 mb-4 rounded-lg bg-gray-700 text-white border border-gray-600 focus:ring-secondary-bg focus:border-secondary-bg">

                <!-- MOVED TO SECOND: Sub-Headline Text -->
                <label for="sub-headline-input" class="block text-sm font-medium text-gray-300 mb-1">Sub-Headline Text</label>
                <input type="text" id="sub-headline-input" value="THE HEALTHY RECIPE COLLECTION" class="w-full p-2 mb-4 rounded-lg bg-gray-700 text-white border border-gray-600 focus:ring-secondary-bg focus:border-secondary-bg">
                
                <!-- REMAINS AT BOTTOM: Slogan / Description -->
                <label for="slogan-input" class="block text-sm font-medium text-gray-300 mb-1">Slogan / Description</label>
                <textarea id="slogan-input" rows="3" class="w-full p-2 rounded-lg bg-gray-700 text-white border border-gray-600 focus:ring-secondary-bg focus:border-secondary-bg">Discover 15 easy, healthy and tasty recipes, including: breakfast, lunch, dinner, treat and smoothies</textarea>
                
                <!-- Image File Input -->
                <label for="image-file-input" class="block text-sm font-medium text-gray-300 mb-1 mt-4">Upload Main Recipe Image</label>
                <input type="file" id="image-file-input" accept="image/*" class="w-full p-2 rounded-lg bg-gray-700 text-white border border-gray-600 focus:ring-secondary-bg focus:border-secondary-bg file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-secondary-bg file:text-white hover:file:bg-green-600">
            </div>

            <!-- Logo Controls -->
            <div class="control-group">
                <h3 class="text-xl font-semibold text-white mb-3">Logo (Above Headline)</h3>
                
                <!-- Logo Image File Input -->
                <label for="logo-file-input" class="block text-sm font-medium text-gray-300 mb-1 mt-4">Upload Logo File</label>
                <input type="file" id="logo-file-input" accept="image/*" class="w-full p-2 rounded-lg bg-gray-700 text-white border border-gray-600 focus:ring-secondary-bg focus:border-secondary-bg file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-secondary-bg file:text-white hover:file:bg-green-600">

                <label for="logo-size" class="block text-sm font-medium text-gray-300 mb-1 mt-4">Logo Max Height (px)</label>
                <input type="range" id="logo-size" min="0" max="100" value="50" class="range-input">
                <span id="logo-size-display" class="text-xs text-gray-400">50px (Set to 0 to hide logo)</span>
            </div>

            <!-- Layout Controls -->
            <div class="control-group">
                <h3 class="text-xl font-semibold text-white mb-3">Layout</h3>
                <label for="image-position" class="block text-sm font-medium text-gray-300 mb-2">Image Position</label>
                <select id="image-position" class="w-full p-2 rounded-lg bg-gray-700 text-white border border-gray-600 focus:ring-secondary-bg focus:border-secondary-bg">
                    <option value="top">Image at Top (50/50 Split)</option>
                    <option value="bottom">Image at Bottom (50/50 Split)</option>
                    <option value="top-2-3">Image at Top (2/3 Size)</option>
                    <option value="bottom-2-3">Image at Bottom (2/3 Size)</option>
                </select>
            </div>

            <!-- Border Controls (NEW) -->
            <div class="control-group">
                <h3 class="text-xl font-semibold text-white mb-3">Border</h3>
                
                <div class="flex items-center mb-4">
                    <input type="checkbox" id="border-toggle" class="h-4 w-4 text-secondary-bg rounded border-gray-500 focus:ring-secondary-bg">
                    <label for="border-toggle" class="ml-2 block text-sm font-medium text-gray-300">Enable Border</label>
                </div>
                
                <label for="border-color" class="block text-sm font-medium text-gray-300 mb-1">Border Color</label>
                <input type="color" id="border-color" value="#FFFFFF" class="w-full h-10 mb-4 rounded-lg border-2 border-gray-600">
                
                <label for="border-width" class="block text-sm font-medium text-gray-300 mb-1">Border Width (px)</label>
                <input type="range" id="border-width" min="1" max="20" value="5" class="range-input">
                <span id="border-width-display" class="text-xs text-gray-400">5px</span>
            </div>

            <!-- Style Controls (UPDATED for Gradient) -->
            <div class="control-group">
                <h3 class="text-xl font-semibold text-white mb-3">Colors & Background (Gradient)</h3>

                <label for="bg-color" class="block text-sm font-medium text-gray-300 mb-1">Text Section Color 1 (Primary)</label>
                <input type="color" id="bg-color" value="#4CAF50" class="w-full h-10 mb-4 rounded-lg border-2 border-gray-600">

                <label for="bg-color-2" class="block text-sm font-medium text-gray-300 mb-1">Text Section Color 2 (Gradient)</label>
                <input type="color" id="bg-color-2" value="#2C7A7B" class="w-full h-10 mb-4 rounded-lg border-2 border-gray-600">
                
                <label for="gradient-direction" class="block text-sm font-medium text-gray-300 mb-1">Gradient Direction</label>
                <select id="gradient-direction" class="w-full p-2 mb-4 rounded-lg bg-gray-700 text-white border border-gray-600 focus:ring-secondary-bg focus:border-secondary-bg">
                    <option value="solid">Solid Color</option>
                    <option value="to top">To Top</option>
                    <option value="to bottom" selected>To Bottom</option>
                    <option value="to right">To Right</option>
                    <option value="to left">To Left</option>
                </select>
            </div>
            
            <!-- Image Effects (NEW) -->
            <div class="control-group">
                <h3 class="text-xl font-semibold text-white mb-3">Image Effects</h3>
                
                <label for="overlay-color" class="block text-sm font-medium text-gray-300 mb-1">Overlay Color</label>
                <input type="color" id="overlay-color" value="#000000" class="w-full h-10 mb-4 rounded-lg border-2 border-gray-600">

                <label for="overlay-opacity" class="block text-sm font-medium text-gray-300 mb-1">Overlay Opacity (%)</label>
                <input type="range" id="overlay-opacity" min="0" max="100" value="0" class="range-input">
                <span id="overlay-opacity-display" class="text-xs text-gray-400">0%</span>

                <div class="flex items-center mt-4">
                    <input type="checkbox" id="grayscale-toggle" class="h-4 w-4 text-secondary-bg rounded border-gray-500 focus:ring-secondary-bg">
                    <label for="grayscale-toggle" class="ml-2 block text-sm font-medium text-gray-300">Apply Grayscale Filter</label>
                </div>
            </div>

            <!-- Divider Line Styles -->
            <div class="control-group">
                <h3 class="text-xl font-semibold text-white mb-3">Divider Line Styles</h3>
                
                <label for="divider-color" class="block text-sm font-medium text-gray-300 mb-1">Line Color</label>
                <input type="color" id="divider-color" value="#FFFFFF" class="w-full h-10 mb-4 rounded-lg border-2 border-gray-600">
                
                <label for="divider-thickness" class="block text-sm font-medium text-gray-300 mb-1">Thickness (px)</label>
                <input type="range" id="divider-thickness" min="0" max="10" value="3" class="range-input">
                <span id="divider-thickness-display" class="text-xs text-gray-400">3px (Set to 0 to hide)</span>
            </div>

            <!-- Sub-Headline Styles (NEW) -->
            <div class="control-group">
                <h3 class="text-xl font-semibold text-white mb-3">Sub-Headline Styles</h3>
                
                <!-- NEW CONTROL: Position -->
                <label for="sub-headline-position" class="block text-sm font-medium text-gray-300 mb-1">Position</label>
                <select id="sub-headline-position" class="w-full p-2 mb-4 rounded-lg bg-gray-700 text-white border border-gray-600 focus:ring-secondary-bg focus:border-secondary-bg">
                    <option value="top">Above Headline (Default)</option>
                    <option value="bottom">Below Slogan</option>
                </select>
                
                <label for="sub-headline-color" class="block text-sm font-medium text-gray-300 mb-1">Color</label>
                <input type="color" id="sub-headline-color" value="#FFFFFF" class="w-full h-10 mb-4 rounded-lg border-2 border-gray-600">

                <label for="sub-headline-font" class="block text-sm font-medium text-gray-300 mb-1">Font Family</label>
                <select id="sub-headline-font" class="w-full p-2 mb-4 rounded-lg bg-gray-700 text-white border border-gray-600 focus:ring-secondary-bg focus:border-secondary-bg">
                    <option value="inter">Inter (Sans-Serif, Default)</option>
                    <option value="serif">Playfair Display (Elegant Serif)</option>
                    <option value="mono">Space Mono (Monospace)</option>
                    <option value="oswald">Oswald (Condensed Sans)</option>
                    <option value="pacifico">Pacifico (Fun Script)</option>
                    <option value="slab">Roboto Slab (Slab Serif)</option>
                    <option value="lobster">Lobster (Bold Script)</option>
                    <option value="lora">Lora (Classic Serif)</option>
                    <option value="montserrat">Montserrat (Geometric Sans)</option>
                    <option value="fjalla">Fjalla One (Ultra Condensed)</option>
                    <option value="marker">Permanent Marker (Handwritten)</option>
                    <option value="bebas">Bebas Neue (All Caps Display)</option>
                    <option value="dancing">Dancing Script (Flowing Script)</option>
                    <option value="righteous">Righteous (Geometric Display)</option>
                    <option value="vollkorn">Vollkorn (Strong Serif)</option>
                </select>

                <label for="sub-headline-size" class="block text-sm font-medium text-gray-300 mb-1">Size (px)</label>
                <input type="range" id="sub-headline-size" min="10" max="25" value="14" class="range-input">
                <span id="sub-headline-size-display" class="text-xs text-gray-400">14px</span>
            </div>
            
            <div class="control-group">
                <h3 class="text-xl font-semibold text-white mb-3">Headline Styles</h3>
                
                <label for="headline-color" class="block text-sm font-medium text-gray-300 mb-1">Color</label>
                <input type="color" id="headline-color" value="#FFFFFF" class="w-full h-10 mb-4 rounded-lg border-2 border-gray-600">
                
                <label for="headline-font" class="block text-sm font-medium text-gray-300 mb-1">Font Family (15 Options)</label>
                <select id="headline-font" class="w-full p-2 mb-4 rounded-lg bg-gray-700 text-white border border-gray-600 focus:ring-secondary-bg focus:border-secondary-bg">
                    <option value="inter">Inter (Sans-Serif, Default)</option>
                    <option value="serif">Playfair Display (Elegant Serif)</option>
                    <option value="mono">Space Mono (Monospace)</option>
                    <option value="oswald">Oswald (Condensed Sans)</option>
                    <option value="pacifico">Pacifico (Fun Script)</option>
                    <option value="slab">Roboto Slab (Slab Serif)</option>
                    <option value="lobster">Lobster (Bold Script)</option>
                    <option value="lora">Lora (Classic Serif)</option>
                    <option value="montserrat">Montserrat (Geometric Sans)</option>
                    <option value="fjalla">Fjalla One (Ultra Condensed)</option>
                    <option value="marker">Permanent Marker (Handwritten)</option>
                    <option value="bebas">Bebas Neue (All Caps Display)</option>
                    <option value="dancing">Dancing Script (Flowing Script)</option>
                    <option value="righteous">Righteous (Geometric Display)</option>
                    <option value="vollkorn">Vollkorn (Strong Serif)</option>
                </select>

                <label for="headline-size" class="block text-sm font-medium text-gray-300 mb-1">Size (px)</label>
                <input type="range" id="headline-size" min="30" max="100" value="64" class="range-input">
                <span id="headline-size-display" class="text-xs text-gray-400">64px</span>
            </div>

            <div class="control-group">
                <h3 class="text-xl font-semibold text-white mb-3">Slogan Styles</h3>
                
                <label for="slogan-color" class="block text-sm font-medium text-gray-300 mb-1">Color</label>
                <input type="color" id="slogan-color" value="#FFFFFF" class="w-full h-10 mb-4 rounded-lg border-2 border-gray-600">
                
                <label for="slogan-font" class="block text-sm font-medium text-gray-300 mb-1">Font Family (15 Options)</label>
                <select id="slogan-font" class="w-full p-2 mb-4 rounded-lg bg-gray-700 text-white border border-gray-600 focus:ring-secondary-bg focus:border-secondary-bg">
                    <option value="inter" selected>Inter (Sans-Serif, Default)</option>
                    <option value="serif">Playfair Display (Elegant Serif)</option>
                    <option value="mono">Space Mono (Monospace)</option>
                    <option value="oswald">Oswald (Condensed Sans)</option>
                    <option value="pacifico">Pacifico (Fun Script)</option>
                    <option value="slab">Roboto Slab (Slab Serif)</option>
                    <option value="lobster">Lobster (Bold Script)</option>
                    <option value="lora">Lora (Classic Serif)</option>
                    <option value="montserrat">Montserrat (Geometric Sans)</option>
                    <option value="fjalla">Fjalla One (Ultra Condensed)</option>
                    <option value="marker">Permanent Marker (Handwritten)</option>
                    <option value="bebas">Bebas Neue (All Caps Display)</option>
                    <option value="dancing">Dancing Script (Flowing Script)</option>
                    <option value="righteous">Righteous (Geometric Display)</option>
                    <option value="vollkorn">Vollkorn (Strong Serif)</option>
                </select>

                <label for="slogan-size" class="block text-sm font-medium text-gray-300 mb-1">Size (px)</label>
                <input type="range" id="slogan-size" min="10" max="40" value="18" class="range-input">
                <span id="slogan-size-display" class="text-xs text-gray-400">18px</span>
            </div>
        </div>

        <!-- Cover Preview Panel - FIXED: Now properly constrained to viewport -->
        <div class="lg:w-3/5 w-full flex-shrink-0 flex items-center justify-center p-2 lg:h-full">
            <!-- FIXED: Added max-height constraint to ensure full cover is visible -->
            <div id="cover-preview-container" class="aspect-[1/1.414] shadow-2xl overflow-hidden transition-all duration-300" style="box-sizing: border-box;">
                
                <div id="cover-preview" class="flex flex-col h-full w-full">
                    
                    <!-- Image Section (UPDATED for Overlay and Grayscale) -->
                    <div id="image-section" class="overflow-hidden relative" style="flex-grow: 1;">
                        
                        <!-- Image Overlay Layer -->
                        <div id="image-overlay" class="absolute inset-0 z-10 transition-all duration-300 pointer-events-none" style="background-color: rgba(0,0,0,0);"></div>

                        <!-- Placeholder URL adjusted for A4 aspect ratio -->
                        <img id="cover-image" class="w-full h-full object-cover transition-all duration-300" 
                            src="https://placehold.co/2480x3508/4CAF50/FFFFFF?text=Upload+Recipe+Image" 
                            alt="Cookbook Cover Image"
                            onerror="this.onerror=null; this.src='https://placehold.co/2480x3508/FF5733/FFFFFF?text=Image+Load+Error'"
                        >
                    </div>

                    <!-- Divider Line -->
                    <div id="divider-line" class="w-full transition-all duration-300" style="height: 3px; background-color: #FFFFFF;"></div>

                    <!-- Text Section (UPDATED for Sub-Headline and Gradient) -->
                    <!-- Added 'relative' to allow absolute positioning if needed, but using flex order instead -->
                    <div id="text-section" class="flex flex-col justify-center items-center text-center p-8 transition-all duration-300" style="background-color: #4CAF50; flex-grow: 1;">
                        
                        <!-- Logo Image Slot (Source Order 1) -->
                        <img id="logo-image" 
                            src="https://placehold.co/100x40/000000/FFFFFF?text=LOGO" 
                            alt="Cookbook Logo" 
                            class="mb-2 object-contain hidden transition-all duration-300" 
                            style="max-height: 50px;"
                            onerror="this.onerror=null; this.src='https://placehold.co/100x40/FF5733/FFFFFF?text=Error'"
                        />
                        
                        <!-- Sub-Headline Element (Source Order 2) - Order is dynamically set by JS -->
                        <p id="sub-headline-text" class="text-white text-sm tracking-widest font-bold uppercase opacity-80 mb-1 transition-all duration-300" style="font-family: 'Inter', sans-serif; font-size: 14px; color: #FFFFFF;"></p>
                        
                        <!-- Headline (Source Order 3) -->
                        <h1 id="headline" class="font-bold mb-4 leading-none transition-all duration-300" style="color: #FFFFFF; font-size: 64px; font-family: 'Inter', sans-serif;">MONTH TEN</h1>
                        
                        <!-- Slogan (Source Order 4) -->
                        <p id="slogan" class="transition-all duration-300" style="color: #FFFFFF; font-size: 18px; font-family: 'Inter', sans-serif; opacity: 90%;">Discover 15 easy, healthy and tasty recipes, including: breakfast, lunch, dinner, treat and smoothies</p>
                    </div>
                </div>

            </div>
        </div>

    </div>

</body>
</html>
